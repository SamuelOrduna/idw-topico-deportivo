<!DOCTYPE html>
<html lang="es" data-bs-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Arena Glory{% endblock %}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    {% block head_extra %}{% endblock %}
    <style>
      .card:hover{transform:translateY(-2px);transition:.2s}
      .kbd{padding:.15rem .35rem;border:1px solid var(--bs-border-color);border-radius:.25rem;font-family:monospace}
      .chart-box{position:relative;height:360px}

      :root[data-bs-theme="light"]{
        --legend:#222; --grid:#e5e7eb; --bar-1:#e50914; --bar-2:#111; --card-border-2:#e5e7eb; --brand-red:#e50914;
      }
      :root[data-bs-theme="dark"]{
        --legend:#e9ecef; --grid:#2b2f33; --bar-1:#e50914; --bar-2:#888; --card-border-2:#2b2f33; --brand-red:#e50914;
      }
    </style>

    <script>window.API_BASE = "{{ api_base or 'http://127.0.0.1:8000' }}";</script>
  </head>
  <body class="bg-body">
    <nav class="navbar bg-body-tertiary border-bottom">
      <div class="container-fluid">
        <div class="d-flex align-items-center gap-3">
          <i class="bi bi-trophy fs-3"></i>
          <div class="d-flex flex-column">
            <span class="h4 mb-0">Eventos Deportivos</span>
            <small class="text-secondary">Competiciones de élite mundial</small>
          </div>
        </div>


        <button id="themeToggle" class="btn btn-outline-secondary" type="button" aria-label="Cambiar tema">
          <i class="bi bi-sun"></i>
        </button>
      </div>
    </nav>

    <div class="container my-3">
      <ul class="nav nav-pills gap-2">
        <li class="nav-item"><a class="nav-link {% block tab_events_active %}{% endblock %}" href="/">Eventos</a></li>
        <li class="nav-item"><a class="nav-link {% block tab_stats_active %}{% endblock %}" href="/estadisticas">Estadísticas</a></li>
        <li class="nav-item"><a class="nav-link {% block tab_calendar_active %}{% endblock %}" href="/calendario">Calendario</a></li>
        <li class="nav-item ms-auto"><a class="nav-link" href="/admin"><i class="bi bi-tools me-1"></i>Admin</a></li>
      </ul>
    </div>

    {% block content %}{% endblock %}

    <footer class="container my-4">
      <div class="card">
        <div class="card-body d-flex flex-column flex-md-row align-items-center justify-content-between gap-3">
          <div class="d-flex align-items-center gap-2">
            <i class="bi bi-trophy"></i><span class="fw-semibold">Arena Glory Stats</span>
            <span class="text-secondary">© 2025</span>
          </div>
          <ul class="nav">
            <li class="nav-item"><a class="nav-link px-2" href="#">Acerca</a></li>
            <li class="nav-item"><a class="nav-link px-2" href="#">Privacidad</a></li>
            <li class="nav-item"><a class="nav-link px-2" href="#">Términos</a></li>
            <li class="nav-item"><a class="nav-link px-2" href="#">Soporte</a></li>
          </ul>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      (function () {
        const KEY = "theme";
        const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        const saved = localStorage.getItem(KEY);
        const initial = saved || (prefersDark ? "dark" : "light");
        const root = document.documentElement;
        const btn  = document.getElementById("themeToggle");
        const icon = btn.querySelector("i");

        function setIcon(theme){
          icon.classList.remove("bi-sun","bi-moon");
          icon.classList.add(theme==="dark" ? "bi-sun" : "bi-moon");
        }
        function apply(theme){
          root.setAttribute("data-bs-theme", theme);
          localStorage.setItem(KEY, theme);
          setIcon(theme);

        }

        apply(initial);


        btn.addEventListener("click", () => {
          const cur = root.getAttribute("data-bs-theme");
          apply(cur === "dark" ? "light" : "dark");
        });

        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", e=>{
          if(!localStorage.getItem(KEY)) apply(e.matches ? "dark" : "light");
        });
      })();
    </script>
    {% block scripts %}{% endblock %}
  </body>
</html>
